plugins {
    id 'java'
    id 'org.springframework.boot' version '2.7.11'
    id 'io.spring.dependency-management' version '1.0.15.RELEASE'
}
group = 'com.github.btpka3'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = '1.8'

ext {
    set('springCloudVersion', "2021.0.6")
}

repositories {
    mavenCentral()
}

dependencies {
    // spring boot
    implementation 'org.springframework.boot:spring-boot-starter'
//    implementation 'org.springframework.boot:spring-boot-starter-data-redis'

    // spring-cloud

//    implementation 'org.springframework.cloud:spring-cloud-starter-bus-kafka'
//    implementation 'org.springframework.cloud:spring-cloud-starter-netflix-eureka-client'
//    implementation 'org.springframework.cloud:spring-cloud-starter-circuitbreaker-resilience4j'
//    implementation 'org.springframework.cloud:spring-cloud-starter-circuitbreaker-reactor-resilience4j'
//    implementation 'org.springframework.cloud:spring-cloud-starter-config'
//    implementation 'org.springframework.cloud:spring-cloud-starter-zookeeper-config'
//    implementation 'org.springframework.cloud:spring-cloud-starter-zookeeper-discovery'

    // consul ：服务发现+配置管理
//    implementation 'org.springframework.cloud:spring-cloud-starter-consul-discovery'
//    implementation 'org.springframework.cloud:spring-cloud-stream-reactive'
    implementation 'org.springframework.cloud:spring-cloud-stream'
//    implementation 'org.springframework.cloud:spring-cloud-stream-binders'
//    implementation 'org.springframework.cloud:spring-cloud-stream-binder-kafka'
//    implementation 'org.springframework.cloud:spring-cloud-stream-binder-rabbit'
    // https://github.com/spring-cloud/spring-cloud-stream-binder-aws-kinesis
//    implementation 'org.springframework.cloud:spring-cloud-stream-binder-kinesis'
//    implementation 'org.springframework.cloud:spring-cloud-stream-binder-servlet'
//
//    implementation 'org.springframework.cloud:spring-cloud-starter-openfeign'
    //implementation 'org.springframework.cloud:spring-cloud-starter-feign'
    // https://www.baeldung.com/spring-boot-opentelemetry-setup
    // 应该排除掉： org.springframework.cloud:spring-cloud-sleuth-brave
    // 替换为: org.springframework.cloud:spring-cloud-sleuth-otel-autoconfigure 使用 OpenTelemetry
//    implementation 'org.springframework.cloud:spring-cloud-starter-sleuth'
//    implementation 'org.springframework.cloud:spring-cloud-sleuth-otel-autoconfigure'
//    implementation 'io.opentelemetry:opentelemetry-exporter-otlp' // 1.23.1
//
//    implementation 'org.springframework.cloud:spring-cloud-starter-kubernetes-client'
//    implementation 'org.springframework.cloud:spring-cloud-starter-kubernetes-discoveryclient'
//    implementation 'org.springframework.cloud:spring-cloud-starter-kubernetes-client-config'
//    implementation 'org.springframework.cloud:spring-cloud-starter-kubernetes-client-loadbalancer'
//    implementation 'org.springframework.cloud:spring-cloud-starter-kubernetes-client-all'

    // spring-cloud-alibaba
//    implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-nacos-config'
//    implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-sentinel'
//    //implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-seata'
//    implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-nacos-discovery'
//    implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-sidecar'
//    implementation 'com.alibaba.cloud:spring-cloud-starter-alicloud-schedulerX'
    implementation 'com.alibaba.cloud:spring-cloud-starter-stream-rocketmq'
    //implementation 'com.alibaba.cloud:spring-cloud-stream-binder-rocketmq'

    implementation 'org.apache.rocketmq:rocketmq-spring-boot-starter:2.2.3'
    implementation 'org.apache.rocketmq:rocketmq-client-java:5.0.5'
    implementation 'org.apache.rocketmq:rocketmq-client:5.1.3'

    // aliyun-spring-boot
//    implementation 'com.alibaba.cloud:aliyun-oss-spring-boot-starter'
//    implementation 'com.alibaba.cloud:aliyun-sms-spring-boot-starter'
//    implementation 'com.alibaba.cloud:aliyun-schedulerx-spring-boot-starter'
//    implementation 'com.alibaba.cloud:aliyun-redis-spring-boot-starter'
//    implementation 'com.alibaba.cloud:aliyun-rds-spring-boot-starter'

    // nacos
    //implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-nacos-config'
    //implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-nacos-discovery '
//    implementation 'com.alibaba.nacos:nacos-spring-context:1.1.1'
//    implementation 'com.alibaba.boot:nacos-config-spring-boot-starter:0.2.12'
//    implementation 'com.alibaba.boot:nacos-discovery-spring-boot-starter:0.2.12'

    compileOnly 'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'
    testCompileOnly 'org.projectlombok:lombok'
    testAnnotationProcessor 'org.projectlombok:lombok'

    // https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/registry/nacos/
//    implementation 'org.apache.dubbo:dubbo-spring-boot-starter:2.7.8'
    //implementation 'com.alibaba.nacos:nacos-client:2.1.0'
//
//    implementation 'org.apache.dubbo:dubbo-dependencies-zookeeper-curator5:3.2.0'

//    implementation 'com.alibaba.cloud:aliyun-fc-spring-boot-starter'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'

}

tasks.named('test') {
    useJUnitPlatform()
}
dependencyManagement {
    imports {
        mavenBom "org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}"
        mavenBom "com.alibaba.cloud:spring-cloud-alibaba-dependencies:2022.0.0.0-RC2"
        mavenBom "com.alibaba.cloud:aliyun-spring-boot-dependencies:1.0.0"
        //mavenBom "org.springframework.cloud:spring-cloud-stream"
//        mavenBom "org.apache.dubbo:dubbo-bom:3.2.0"
//        mavenBom "org.apache.dubbo:dubbo-dependencies-bom:3.2.0"
    }
}



/// ========================
//buildscript {
//    ext {
//    }
//    repositories {
//        maven { url "http://maven.aliyun.com/nexus/content/groups/public/" }
//        mavenCentral()
//    }
//    dependencies {
//        classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
//        classpath("io.spring.gradle:dependency-management-plugin:1.0.3.RELEASE")
//        //classpath("gradle.plugin.com.gorylenko.gradle-git-properties:gradle-git-properties:1.4.17")
//    }
//}
//
//
//apply plugin: 'eclipse'
//apply plugin: 'idea'
//apply plugin: "io.spring.dependency-management"
//apply plugin: 'project-report'
//apply plugin: 'java'
//apply plugin: 'org.springframework.boot'
////apply plugin: "com.gorylenko.gradle-git-properties" // 生成 git.properties
//apply plugin: 'maven'
//apply plugin: 'maven-publish'
//
//
//repositories {
//    maven { url "http://maven.aliyun.com/nexus/content/groups/public/" }
//    mavenCentral()
//}
//
//idea {
//    module {
//        downloadJavadoc = false
//        downloadSources = true
//    }
//}
//eclipse {
//    classpath {
//        downloadSources = true
//    }
//}
//dependencyManagement {
//    imports {
//        mavenBom("org.springframework.boot:spring-boot-starter-parent:${springBootVersion}")
//        mavenBom("org.apache.rocketmq:rocketmq-all:4.1.0-incubating")
//    }
//    resolutionStrategy {
//        cacheChangingModulesFor 0, 'seconds'
//    }
//    dependencies {
//
////        dependency("")
//    }
//}


//publishing {
//
//    repositories {
//        maven {
//            credentials {
//                username "admin"
//                password "admin123"
//            }
//            if (project.version.endsWith('-SNAPSHOT')) {
//                url "http://mvn.kingsilk.xyz/content/repositories/snapshots/"
//            } else {
//                url "http://mvn.kingsilk.xyz/content/repositories/releases/"
//            }
//        }
//    }
//}


//task sourcesJar(type: Jar, dependsOn: classes) {
//    classifier = 'sources'
//    from sourceSets.main.allSource
//}
//task javadocJar(type: Jar, dependsOn: javadoc) {
//    classifier = 'javadoc'
//    from javadoc.destinationDir
//}
//
//artifacts {
//    archives sourcesJar
//    //archives javadocJar
//}
//
//dependencies {
////        compile project(":qh-oauth-service")
////        compile project(":qh-oauth-api")
//
//    compile('org.springframework.boot:spring-boot-starter-web')
////
////            <dependency>
////            <groupId>org.apache.rocketmq</groupId>
////            <artifactId>rocketmq-client-java</artifactId>
////            </dependency>
////    compile('org.springframework.boot:spring-boot-starter-security')
////    compile('org.springframework.boot:spring-boot-starter-thymeleaf')
////    compile('org.springframework.boot:spring-boot-starter-data-mongodb')
////    compile("org.springframework.boot:spring-boot-devtools")
////
////    compile('org.apache.httpcomponents:httpclient')
////
////    compile('org.springframework.security.oauth:spring-security-oauth2')
////    compile('org.springframework.security:spring-security-jwt')
////    compile('org.springframework.security:spring-security-web')
////
////
////    compile('com.fasterxml.jackson.dataformat:jackson-dataformat-xml')
////    compile('com.fasterxml.jackson.module:jackson-module-parameter-names')
////    compile('com.fasterxml.jackson.datatype:jackson-datatype-jdk8')
////    compile('com.fasterxml.jackson.datatype:jackson-datatype-jsr310')
////
////    compile('com.querydsl:querydsl-mongodb')
////    compile('com.querydsl:querydsl-apt')
////    compile('com.querydsl:querydsl-core')
////    compile('joda-time:joda-time')
//    //compile('org.mongodb.morphia:morphia')
//    //querydslapt('com.querydsl:querydsl-apt')
//
////    compile "io.swagger:swagger-core"  // 1.5.12
////    compile "io.springfox:springfox-swagger2"
////    compile "io.springfox:springfox-data-rest"
////    compile "io.springfox:springfox-staticdocs"
////    compile 'io.springfox:springfox-swagger-ui'
//
////    compile('org.springframework.boot:spring-boot-starter-jersey')
////    compile('org.glassfish.jersey.ext:jersey-spring3')
////
////    compile('io.swagger:swagger-core')
////    compile('io.swagger:swagger-jersey2-jaxrs')
////    compile('org.webjars:swagger-ui')
////
////
////    compile('org.springframework.session:spring-session')
////    compile('org.springframework.session:spring-session-data-mongo')
////
////    testCompile('org.springframework.boot:spring-boot-starter-test')
//    compile('org.apache.rocketmq:rocketmq-example')
//    compile('org.apache.rocketmq:rocketmq-client')
//
//}
//
//test {
//    include 'me/test/**'
//    testLogging.showStandardStreams = false
//}
//
//bootRepackage {
//    enabled = true
//    withJarTask jar
//    classifier = 'boot'
//}
//
//bootRun {
//    addResources = true
//    systemProperties = System.properties
//}
//
//springBoot {
//    //mainClass = System.properties['mainClass']
//    buildInfo {
//        additionalProperties = [
//                'foo': 'bar'
//        ]
//    }
//}
//
//jar {
//    manifest {
//        attributes "Implementation-Version": project.version
//    }
//}
//
//publish {
//    dependsOn assemble
//}
//
//publishing {
//    publications {
//        mavenJava(MavenPublication) {
//            from components.java
//
//            artifact sourcesJar {
//                classifier "sources"
//            }
//
//            artifact(file("${buildDir}/libs/${project.name}-${project.version}-${bootRepackage.classifier}.jar")) {
//                classifier 'boot'
//            }
//        }
//    }
//}
